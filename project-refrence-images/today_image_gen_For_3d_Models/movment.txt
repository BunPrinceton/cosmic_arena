extends Node3D

@export var move_speed := 5.0
@export var mouse_sensitivity := 0.002

@onready var camera := $Camera3D

var pitch := 0.0

func _ready():
    Input.set_mouse_mode(Input.MOUSE_MODE_CAPTURED)

func _unhandled_input(event):
    if event is InputEventMouseMotion:
        rotate_y(-event.relative.x * mouse_sensitivity)
        pitch = clamp(
            pitch - event.relative.y * mouse_sensitivity,
            deg_to_rad(-85),
            deg_to_rad(85)
        )
        camera.rotation.x = pitch

func _process(delta):
    var direction := Vector3.ZERO

    if Input.is_action_pressed("move_forward"):
        direction -= transform.basis.z
    if Input.is_action_pressed("move_backward"):
        direction += transform.basis.z
    if Input.is_action_pressed("move_left"):
        direction -= transform.basis.x
    if Input.is_action_pressed("move_right"):
        direction += transform.basis.x
    if Input.is_action_pressed("move_up"):
        direction += transform.basis.y
    if Input.is_action_pressed("move_down"):
        direction -= transform.basis.y

    if direction != Vector3.ZERO:
        translate(direction.normalized() * move_speed * delta)
